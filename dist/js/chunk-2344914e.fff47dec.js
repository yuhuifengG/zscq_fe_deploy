(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2344914e"],{"19c5":function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",["view"!=t.wkFlowOptions.actionType?i("div",{staticClass:"fd-nav"},[i("div",{staticClass:"fd-nav-left"},[i("div",{staticClass:"fd-nav-back",on:{click:function(a){return t.$router.go(-1)}}},[i("i",{staticClass:"anticon anticon-left",attrs:{"aria-label":"icon: left"}},[i("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"left",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"}},[i("path",{attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}})])])]),i("div",{staticClass:"fd-nav-title"},[t._v(" "+t._s(t.data1.title)+" ")])]),t._m(0),i("div",{staticClass:"fd-nav-right"},[i("button",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"ant-btn button-preview",attrs:{type:"button"},on:{click:t.preview}},[i("span",[t._v("预 览")])]),i("button",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"ant-btn button-preview",staticStyle:{height:"30px"},attrs:{type:"button"},on:{click:t.save}},[i("span",[t._v("保 存")])])])]):t._e(),i("div",{staticClass:"fd-nav-content"},[i("div",{staticClass:"dingflow-design"},[i("div",{staticClass:"ie-polyfill-container"},[i("div",{key:t.key,staticClass:"box-scale",staticStyle:{"min-height":"auto"},attrs:{id:"box-scale"}},[t._l(t.items,(function(a,e){return i("Node",{key:e,attrs:{node:a,wkFlowOptions:t.wkFlowOptions},on:{addnode:t.addnode,delNode:function(i){return t.delNode(a)}}})})),i("EndNode"),i("AModal",{attrs:{dialog:t.viewModal},on:{"update:dialog":function(a){t.viewModal=a}}},[i("pre",{staticStyle:{"font-family":"Monaco,Menlo,Consolas,Bitstream Vera Sans Mono,monospace","font-size":"14px"}},[t._v(t._s(JSON.stringify(t.data1.node,null,4)))])]),i("ErrorsModal",{attrs:{dialog:t.errorsModal,data:t.errors},on:{"update:dialog":function(a){t.errorsModal=a}}})],2)])])])])},s=[function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"fd-nav-center"},[i("div",{staticClass:"fd-nav-container"},[i("div",{staticClass:"fd-nav-item"},[t._v(" 审批流设计 ")])])])}],n=(i("99af"),i("4160"),i("c975"),i("b0c0"),i("ac1f"),i("1276"),i("159b"),i("2909")),o=(i("96cf"),i("1da1")),r=i("f6bb"),d=function(){var t=this,a=t.$createElement;t._self._c;return t._m(0)},l=[function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"end-node"},[i("div",{staticClass:"end-node-circle"}),i("div",{staticClass:"end-node-text"},[t._v(" 流程结束 ")])])}],c={name:"EndNode"},u=c,f=i("2877"),h=Object(f["a"])(u,d,l,!1,null,null,null),v=h.exports,p=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("AModal",{attrs:{dialog:t.dialog1},on:{"update:dialog":function(a){t.dialog1=a}}},[i("div",{staticClass:"ant-modal-body"},[i("div",{staticClass:"ant-modal-confirm-body-wrapper"},[i("div",{staticClass:"ant-modal-confirm-body"},[i("i",{staticClass:"anticon anticon-close-circle",attrs:{"aria-label":"icon: close-circle"}},[i("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"close-circle",width:"1em",height:"1em",fill:"currentColor"}},[i("path",{attrs:{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"}}),i("path",{attrs:{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}})])]),i("span",{staticClass:"ant-modal-confirm-title"},[t._v("当前无法发布")]),i("div",{staticClass:"ant-modal-confirm-content"},[i("div",[i("p",{staticClass:"error-modal-desc"},[t._v(" 以下内容不完善，需进行修改 ")]),i("div",{staticClass:"error-modal-list"},t._l(t.data,(function(a,e){return i("div",{key:e,staticClass:"error-modal-item"},[i("div",{staticClass:"error-modal-item-label"},[t._v(" 流程设计 ")]),i("div",{staticClass:"error-modal-item-content"},[t._v(" "+t._s(a.name)+" 未选择 ")])])})),0)])])]),i("div",{staticClass:"ant-modal-confirm-btns"},[i("button",{staticClass:"ant-btn btn-workflow",attrs:{type:"button"},on:{click:function(a){t.dialog1=!1}}},[i("span",[t._v("我知道了")])])])])])])},m=[],b={components:{AModal:r["a"]},props:{dialog:{type:Boolean,default:!1},data:{type:Array,default:void 0}},data:function(){return{dialog1:!1}},watch:{dialog:function(t){this.dialog1=t},dialog1:function(t){this.$emit("update:dialog",t)}}},g=b,w=Object(f["a"])(g,p,m,!1,null,null,null),C=w.exports,y=i("7037"),_=(i("f36f"),i("d0c2")),O={name:"WorkflowUi",components:{EndNode:v,AModal:r["a"],ErrorsModal:C},props:{data:{type:Object,default:void 0},wkFlowOptions:{type:Object,default:void 0}},data:function(){return{items:[],errorsModal:!1,errors:[],viewModal:!1,data1:{},contitionList:[],flag:[],key:0}},watch:{data:{handler:function(t){this.data1=t},deep:!0}},mounted:function(){this.data&&this.data.node&&(this.data1=this.data),this.data1.node||this.initialNode(),this.data1.node.properties||(this.data1.node.properties={actionerRules:[{id:"declare_user",name:"申报用户",type:"role"}]}),this.iteratorData(this.data1.node);for(var t=JSON.stringify(this.data1),a=t.split("${"),i=[],e=1;e<a.length;e++){var s=a[e].indexOf("}"),n=a[e].substring(0,s);i.push(n)}this.getConditionSelect(i)},methods:{initialNode:function(){this.data1.node={name:"发起人",type:"start",nodeId:"sid-startevent",properties:{actionerRules:[{id:"declare_user",name:"申报用户",type:"role"}]}}},iteratorData:function(t){this.items=[],Object(y["e"])(this.items,t)},addnode:function(t){Object(y["a"])(t,this.data1.node,this.items,5),this.key++},delNode:function(t){Object(y["d"])(t,this.data1.node,this.items,5),this.key++},save:function(){var t=Object(y["b"])(this.data1.node);if(t.length>0)return this.errorsModal=!0,void(this.errors=t);for(var a=JSON.stringify(this.data1),i=a.split("${"),e=[],s=1;s<i.length;s++){var n=i[s].indexOf("}"),o=i[s].substring(0,n);e.push(o)}this.getConditionSelect(e),this.flag.length>0||this.$emit("ok",this.data1)},getConditionSelect:function(t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var e;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:try{e=[].concat(Object(n["a"])(_["a"]),Object(n["a"])(_["b"])),a.contitionList=[],e.forEach((function(t){a.contitionList.push(t.name)})),a.isTips(t)}catch(s){}case 1:case"end":return i.stop()}}),i)})))()},isTips:function(t){var a=this;this.flag=[],t.forEach((function(t){-1===a.contitionList.indexOf(t)&&a.flag.push(t)})),this.flag.length>0&&this.$notification.warning({message:"提示",description:"条件字段错误"+JSON.stringify(this.flag)+"不存在表单中"})},preview:function(){var t=Object(y["b"])(this.data1.node);if(t.length>0)return this.errorsModal=!0,void(this.errors=t);this.viewModal=!0}},computed:{isShow:function(){return!0}}},k=O,M=Object(f["a"])(k,e,s,!1,null,"2bab7dbb",null),S=M.exports;i("796e"),a["a"]=S},"883e":function(t,a,i){}}]);