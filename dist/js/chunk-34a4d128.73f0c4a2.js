(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34a4d128"],{"027f":function(e,t,r){"use strict";var o=r("a3e3"),a=r.n(o);a.a},"3e42":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.showWorkflow?r("div",{staticClass:"showWorkflow"},[r("workflow",{staticClass:"workflowWp",attrs:{data:e.workflowData,wkFlowOptions:e.wkFlowOptions},on:{ok:e.changeWorkflowClick}})],1):e._e()},a=[],n=(r("b0c0"),r("96cf"),r("1da1")),i=r("19c5"),s=(r("883e"),r("f36f")),c={name:"EditWorkFlow",components:{workflow:i["a"]},data:function(){return{obj:null,workflowData:{title:this.$route.query.name,node:{name:"发起人",type:"start",nodeId:"sid-startevent",properties:{actionerRules:[{id:"declare_user",name:"申报用户",type:"role"}]},childNode:{}}},showWorkflow:!1,userInfo:{},grant_id:"",tenant_id:"",isSaveFirst:!0,wkFlowOptions:{actionType:"edit"}}},created:function(){this.userInfo=this.$ls.get("USER_INFO"),this.grant_id=this.userInfo.id,this.tenant_id=this.userInfo.subSystemId,localStorage.setItem("main_id",this.$route.query.id),localStorage.setItem("metadata_id",this.$route.query.metadata_id),localStorage.setItem("metadata_type","form"),this.$route.query.model_id&&this.getChildNode(this.$route.query.model_id),"view"==this.$route.query.actionType&&(this.wkFlowOptions.actionType=this.$route.query.actionType)},methods:{getChildNode:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(s["h"])({model_id:e});case 3:o=r.sent,1e4===o.code?(a=JSON.parse(o.data.resource),t.workflowData.node=a,t.isSaveFirst=!1,t.showWorkflow=!0):20005===o.code&&(t.workflowData.node.childNode={},t.isSaveFirst=!0,t.showWorkflow=!0),r.next=9;break;case 7:r.prev=7,r.t0=r["catch"](0);case 9:case"end":return r.stop()}}),r,null,[[0,7]])})))()},changeWorkflowClick:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var o,a,n,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.isSaveFirst||t.$route.query.getWorkflow){r.next=14;break}return o={id:t.$route.query.id,name:t.$route.query.name,edit_type:1,resource:JSON.stringify(e.node)},r.prev=2,a={tenant_id:t.tenant_id,grant_id:t.grant_id},r.next=6,Object(s["o"])(a,o);case 6:n=r.sent,1e4===n.code?(t.$notification.success({message:"操作成功",description:"请重新发布，否则工作流仍然调用修改前的版本"}),setTimeout((function(){t.$router.go(-1)}),500)):t.$notification.warning({message:"提示",description:n.msg}),r.next=12;break;case 10:r.prev=10,r.t0=r["catch"](2);case 12:r.next=24;break;case 14:return i={metadata_id:localStorage.getItem("metadata_id"),model_id:t.$route.query.id,resource:JSON.stringify(e.node)},r.prev=15,r.next=18,Object(s["q"])(i);case 18:c=r.sent,1e4===c.code?t.$router.go(-1):t.$notification.warning({message:c.msg,duration:4}),r.next=24;break;case 22:r.prev=22,r.t1=r["catch"](15);case 24:case"end":return r.stop()}}),r,null,[[2,10],[15,22]])})))()}}},u=c,d=(r("027f"),r("2877")),l=Object(d["a"])(u,o,a,!1,null,"b0632518",null);t["default"]=l.exports},a3e3:function(e,t,r){}}]);