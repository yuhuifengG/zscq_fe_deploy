(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-351e2915"],{"0e14":function(e,t,a){},"1c9d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{style:{height:"100%"},attrs:{bordered:!1}},[a("a-alert",{staticStyle:{marginBottom:"20px"},attrs:{message:"角色/权限修改后,需重新登录获取权限",banner:"",closable:"",type:"info"}}),a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"角色名称"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{directives:[{name:"action",rawName:"v-action:role_findUser",arg:"role_findUser"}],attrs:{type:"primary"},on:{click:e.getRole}},[e._v("查询")])],1)])],1),a("a-button",{directives:[{name:"action",rawName:"v-action:role_add",arg:"role_add"}],staticStyle:{"margin-left":"8px"},attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$refs.createRole.add("","add")}}},[e._v("新增角色")])],1)],1),a("a-table",{attrs:{columns:e.columns,dataSource:e.data,rowKey:"id"},on:{change:e.pageChange},scopedSlots:e._u([{key:"action",fn:function(t,n){return a("span",{},[n.permitted?a("a",{on:{click:function(t){return e.handeAddaut(n)}}},[e._v("授权")]):e._e(),a("a-divider",{directives:[{name:"action",rawName:"v-action:role_findUser",arg:"role_findUser"}],attrs:{type:"vertical"}}),a("a",{directives:[{name:"action",rawName:"v-action:role_findUser",arg:"role_findUser"}],on:{click:function(t){return e.searchUser(n)}}},[e._v("查找用户")]),n.permitted?a("a-divider",{directives:[{name:"action",rawName:"v-action:role_de",arg:"role_de"}],attrs:{type:"vertical"}}):e._e(),n.permitted?a("a",{directives:[{name:"action",rawName:"v-action:role_de",arg:"role_de"}],on:{click:function(t){return e.edit(n)}}},[e._v("修改")]):e._e(),n.permitted?a("a-divider",{directives:[{name:"action",rawName:"v-action:role_de",arg:"role_de"}],attrs:{type:"vertical"}}):e._e(),a("a",{directives:[{name:"show",rawName:"v-show",value:n.permitted,expression:"record.permitted"},{name:"debounce",rawName:"v-debounce",value:function(){e.handleDelete(n)},expression:"()=>{handleDelete(record)}"},{name:"action",rawName:"v-action:role_de",arg:"role_de"}],staticClass:"adanger"},[e._v("删除")])],1)}}])}),a("a-modal",{attrs:{centered:"centered",width:"800","mask-closable":!1,okText:"确认",cancelText:"取消"},on:{ok:e.menAction},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-table",{attrs:{columns:e.columnsMenu,"data-source":e.treeData,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"elementType",fn:function(t,a){return[e._v(" "+e._s("1"==a.elementType?"工作流":"")+" ")]}},{key:"action",fn:function(t){return[a("a",{on:{click:function(a){return e.checkAuth(t)}}},[e._v("查看权限")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(a){return e.updateAuth(t)}}},[e._v("修改权限")])]}}])})],1),a("a-modal",{attrs:{width:"1000px",title:e.getTitle},on:{ok:e.limitSubmit},model:{value:e.visibleLimit,callback:function(t){e.visibleLimit=t},expression:"visibleLimit"}},["edit"===e.authType?[a("div",{staticStyle:{marginBottom:"20px"}},[a("a-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(){return e.limitData.push({editable:!0})}}},[e._v("添加")])],1),a("a-table",{attrs:{columns:e.columnsLimit,rowKey:"id","data-source":e.limitData,scroll:{x:!0},"row-selection":{selectedRowKeys:e.selectLimitKeys,onChange:e.onSelectLimitChange},pagination:!1},scopedSlots:e._u([e._l(e.columnsLimit,(function(t,n){return{key:t.dataIndex,fn:function(i,r){return t.scopedSlots?[a("div",{key:n},[r.editable&&"input"==t.scopedSlots.type?a("a-input",{model:{value:r[t.dataIndex],callback:function(a){e.$set(r,t.dataIndex,a)},expression:"record[item.dataIndex]"}}):r.editable&&"inputNumber"==t.scopedSlots.type?a("a-input-number",{attrs:{min:0},model:{value:r[t.dataIndex],callback:function(a){e.$set(r,t.dataIndex,a)},expression:"record[item.dataIndex]"}}):[e._v(e._s(r[t.dataIndex]))]],2)]:void 0}}})),{key:"action",fn:function(t,n,i){return[n.editable?[a("a",{directives:[{name:"debounce",rawName:"v-debounce",value:function(){e.classifySave(n)},expression:"()=>{classifySave(record)}"}]},[e._v("保存")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.classifyCancel(n)}}},[e._v("取消")])]:[a("a",{on:{click:function(t){return e.classifyEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{directives:[{name:"debounce",rawName:"v-debounce",value:function(){e.classifyDelete(n,i)},expression:"()=>{classifyDelete(record, index)}"}],staticClass:"adanger"},[e._v("删除")])]]}}],null,!0)})]:e._l(e.authList,(function(t){return a("a-button",{key:t.id,staticClass:"auth-btn"},[e._v(e._s(t.authName))])}))],2),a("add-role",{ref:"createRole",on:{childFn:e.parentFn}}),a("a-modal",{attrs:{centered:"centered","mask-closable":!1},on:{cancel:e.handleStepOk},model:{value:e.visible1,callback:function(t){e.visible1=t},expression:"visible1"}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("提示")]),a("template",{slot:"footer"},[a("div",{style:{textAlign:"center"}},[a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.handleStepOk}},[e._v("关闭")])],1)]),a("div",{staticStyle:{"margin-bottom":"10px"}},[a("a-input",{staticStyle:{width:"50%","margin-right":"10px"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("a-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查找")])],1),a("div",{staticClass:"step-form-wrapper"},[a("a-table",{attrs:{columns:e.columnsUser,dataSource:e.dataUser,rowKey:"id",pagination:e.paginationSearch},on:{change:e.pageChangeSearch}})],1)],2)],1)},i=[],r=(a("4de4"),a("4160"),a("caad"),a("a434"),a("b0c0"),a("2532"),a("159b"),a("5530")),s=(a("96cf"),a("1da1")),o=a("8593"),c=a("ac0d"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{width:960,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1,destroyOnClose:!0,footer:null},on:{cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{colon:!1,form:e.form}},[a("a-card",{attrs:{title:"角色信息",bordered:!1}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"角色名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入角色名！"}]}],expression:"['name', {rules: [{ required: true, message: '请输入角色名！' }]}]"}],attrs:{placeholder:"请输入角色名"}})],1)],1),a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"编码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{rules:[{required:!0,message:"请输入编码！"}]}],expression:"['code', {rules: [{required: true, message: '请输入编码！'}]}]"}],attrs:{placeholder:"请输入编码！"}})],1)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"角色等级列表"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["level",{rules:[{required:!0,message:"请选择角色等级"}]}],expression:"['level', {rules: [{required: true, message: '请选择角色等级'}]}]"}],attrs:{placeholder:"请选择角色等级"},on:{change:e.levelChange}},e._l(e.levelList,(function(t){return a("a-select-option",{key:t.level,attrs:{value:t.level}},[e._v(e._s(t.desc))])})),1)],1)],1),e.showOrganization?a("a-col",{attrs:{md:12,sm:24}},[a("a-form-item",{attrs:{label:"组织机构"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptIds",{rules:[{required:!0,message:"请选择组织机构"}]}],expression:"['deptIds', {rules: [{required: true, message: '请选择组织机构'}]}]"}],attrs:{placeholder:"请选择组织机构",mode:"multiple",filterOption:!1},on:{search:e.searchOrganization}},e._l(e.showOrganizationList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1):e._e()],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"角色说明"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["describe",{}],expression:"['describe', {}]"}],attrs:{placeholder:"请输入角色说明",autoSize:{minRows:4,maxRows:6}}})],1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24,align:"center"}},[a("a-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleSubmit,expression:"handleSubmit"}],attrs:{type:"primary"}},[e._v("保存")]),a("a-button",{staticStyle:{"margin-left":"20px"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)],1)],1),a("dept-list",{ref:"selectDept",on:{childFn:e.parentFn}})],1)},l=[],u=(a("d81d"),a("b64b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticStyle:{top:"10px"},attrs:{width:600,visible:e.visible,maskClosable:!1,destroyOnClose:!0,footer:null},on:{cancel:e.handleCancel}},[a("a-card",{staticClass:"content",attrs:{bordered:!1}},[a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",order:"true",columns:e.columns,data:e.loadData,rowSelection:e.rowSelection,expandIconColumnIndex:2,expandedRowKeys:e.expandedRowKeys,childrenColumnName:"subData",showPagination:"auto"},on:{expand:e.onExpand}}),a("a-row",[a("a-col",{attrs:{span:24,align:"center"}},[a("a-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleSubmit,expression:"handleSubmit"}],attrs:{type:"primary"}},[e._v("保存")]),a("a-button",{staticStyle:{"margin-left":"20px"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)],1)],1)}),m=[],h=(a("99af"),a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("3835")),p=a("2af9"),f=a("d60c"),b=a("c04c"),v=a.n(b),g={name:"Dept",components:{DeptListSubTable:f["a"],STable:p["c"]},data:function(){return{advanced:!1,queryParam:{},selectedRowKeys:[],selectedRows:[],expandedRowKeys:[],questSubDept:{state:"done",data:null},stateListData:null,dataMap:new Map,visible:!1,columns:[{title:"组织名称",dataIndex:"name"}]}},computed:{rowSelection:function(){return{type:"checkbox",selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{handleSubmit:function(){this.$emit("childFn",{id:this.selectedRowKeys,name:this.selectedRows[0].name}),this.visible=!1},handleCancel:function(){this.visible=!1},setVisible:function(){this.visible=!0},loadData:function(e){var t,a,n=this,i=this.questSubDept,r=i.state,s=i.data;"ready"===r?(this.questSubDept.state="doing",t=this.loadSubDept(null!==(a=null===s||void 0===s?void 0:s.id)&&void 0!==a?a:"")):"done"===r&&(t=this.loadTopDept(e));return Promise.all([t,this.loadStateData()]).then((function(e){var t=Object(h["a"])(e,2),a=t[0],i=t[1];return n.stateListData=i,a}))},loadStateData:function(){var e;return e=null===this.stateListData?Object(o["rb"])().then((function(e){return e.data})).catch((function(e){return null})):Promise.resolve(this.stateListData),e},loadTopDept:function(e){var t=this;this.dataMap.clear(),this.expandedRowKeys=[];var a=Object.assign({});return!0!==this.queryParam.unitLegalFlag?delete a.unitLegalFlag:a.unitLegalFlag=1,Object(o["db"])({},1,10).then((function(e){var a,n=null!==(a=e.data)&&void 0!==a?a:{records:[],pageNo:0,total:0};return t.appendSubProp(n.records),{data:n.records,totalCount:n.total,pageNo:n.current}})).catch((function(e){throw t.$error({title:"查询失败",content:e.message}),e}))},loadSubDept:function(e){var t=this,a=this.$refs.table,n=a.localDataSource,i=a.localPagination;return Object(o["ib"])(e).then((function(a){var r,s=t.dataMap.get(e);s&&(t.appendSubProp(a.data),s.subData=null!==(r=a.data)&&void 0!==r?r:[],s.__loaded=!0);return{data:n,totalCount:i.total,pageNo:i.current}})).then((function(e){return t.questSubDept.state="done",t.questSubDept.data=null,e})).catch((function(e){t.$notification.error({message:"查询失败",description:e.message})}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onExpand:function(e,t){if(e){if(this.expandedRowKeys.push(t.id),!0===t.__loaded)return;this.questSubDept.state="ready",this.questSubDept.data=t,this.$refs.table.refresh()}else v()(this.expandedRowKeys,(function(e){return e===t.id})),this.expandedRowKeys=[].concat(this.expandedRowKeys)},appendSubProp:function(e){var t=this;e&&e.length&&e.forEach((function(e){var a;t.dataMap.set(e.id,e),(null===(a=e.subDeptList)||void 0===a?void 0:a.length)&&(e.subData=[])}))},refreshItem:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,r,s,c,d,l,u,m;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("addSub"!==t){n.next=16;break}if(e){n.next=4;break}return a.$refs.table.refresh(!0),n.abrupt("return");case 4:return n.next=6,Object(o["ib"])(e);case 6:i=n.sent,r=i.data,s=a.dataMap.get(e),c=s.subData,d=!1,c||(c=s.subData=[],d=!0),r.forEach((function(e){a.dataMap.has(e.id)||(a.appendSubProp([e]),s.subData=[].concat(c,[e]))})),d&&a.$refs.table.$forceUpdate(),n.next=22;break;case 16:return n.next=18,Object(o["F"])(e);case 18:l=n.sent,u=l.data,m=a.dataMap.get(u.id),Object.assign(m,u);case 22:case"end":return n.stop()}}),n)})))()}}},y=g,w=a("2877"),x=Object(w["a"])(y,u,m,!1,null,null,null),S=x.exports,k={name:"AddRole",components:{DeptList:S},data:function(){return{mode:"add",visible:!1,confirmLoading:!1,level:0,form:this.$form.createForm(this,{}),deptId:"",levelList:[],roleTypeList:[],showOrganization:!1,options:[],organizationList:[],showOrganizationList:[],replaceFields:{children:"children",title:"name",key:"id",value:"id"}}},methods:{parentFn:function(e){this.deptId=e.id[0],this.form.setFieldsValue({deptName:e.name})},selectAll:function(){this.$refs.selectDept.setVisible()},add:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a.visible=!0,a.mode=t,a.showOrganization=e&&6===e.level,"edit"!==t){n.next=13;break}return a.mode="edit",a.loadRole(e.id),n.next=8,Object(o["F"])(e.deptId);case 8:i=n.sent,a.form.setFieldsValue({deptName:i.data.name}),a.deptId=e.deptId,n.next=14;break;case 13:a.showOrganization=!1;case 14:case"end":return n.stop()}}),n)})))()},loadRole:function(e){var t=this;this.confirmLoading=!0,this.form.getFieldDecorator("id",{initialValue:"",preserve:!0}),Object(o["sb"])(e).then((function(e){var a=null===e||void 0===e?void 0:e.data;if(a){var n={id:a.id};Object.keys(t.form.getFieldsValue()).forEach((function(e){Object.prototype.hasOwnProperty.call(a,e)&&(n[e]=a[e])})),t.form.setFieldsValue(n),t.form.setFieldsValue({deptId:a.deptId}),6==a.level&&Object(o["y"])({roleId:a.id}).then((function(e){if(e.success){var a=e.data.map((function(e){return e.id}));t.form.setFieldsValue({deptIds:a})}}))}t.confirmLoading=!1})).catch((function(e){t.$error({title:"查询失败",content:e.message}),t.confirmLoading=!1}))},handleSubmit:function(){var e=this,t=this.form.validateFields;this.confirmLoading=!0,t((function(t,a){if(t)e.$message.warning("页面验证失败，请检查填写是否正确"),e.confirmLoading=!1;else{var n="add"===e.mode?o["g"]:o["ub"],i=new FormData;Object.keys(a).forEach((function(e){i.append(e,a[e]||"")})),n(i).then((function(t){t.success?(e.visible=!1,e.$emit("ok",a),e.$message.success("保存成功"),e.$emit("childFn",1)):e.$error({title:"保存失败",content:t.msg}),e.confirmLoading=!1})).catch((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.message;e.$error({title:"保存失败",content:a}),e.confirmLoading=!1}))}}))},handleCancel:function(){this.visible=!1},levelChange:function(e){this.showOrganization=6===e},searchOrganization:function(e){e||(this.showOrganizationList=this.organizationList),this.showOrganizationList=this.organizationList.filter((function(t){if(t.name)return t.name.includes(e)}))},treeExpand:function(e){}},mounted:function(){var e=this;Object(o["Z"])().then((function(t){e.levelList=t.data})),Object(o["bb"])().then((function(t){e.showOrganizationList=e.organizationList=t.data})),Object(o["mb"])().then((function(t){e.roleTypeList=t.data}))}},_=k,D=Object(w["a"])(_,d,l,!1,null,null,null),L=D.exports,R=a("c1df"),O=a.n(R),I=[{title:"账号",dataIndex:"loginName",width:150},{title:"真实姓名",dataIndex:"realName",width:150},{title:"手机号码",dataIndex:"mobileNumber",key:"mobileNumber",width:150}],$={onChange:function(e,t){},onSelect:function(e,t,a){},onSelectAll:function(e,t,a){}},N={name:"RoleList",mixins:[c["c"]],components:{AddRole:L},watch:{visible1:function(e){e&&(this.keyword="")}},data:function(){var e=this;return{visible1:!1,data:[],columns:[{title:"序号",width:"100px",align:"center",customRender:function(t,a,n){return(e.pagination.current-1)*e.pagination.pageSize+(n+1)}},{title:"角色名称",dataIndex:"name",key:"name"},{title:"角色说明",dataIndex:"describe",key:"describe"},{title:"创建时间",dataIndex:"createdTime",key:"createdTime",width:"200px",customRender:function(e){return e?O()(e).format("YYYY-MM-DD"):null}},{title:"操作",width:"240px",align:"center",scopedSlots:{customRender:"action"}}],columnsMenu:[{title:"菜单",dataIndex:"name",width:"240px"},{title:"工作流状态",dataIndex:"elementType",width:"102px",scopedSlots:{customRender:"elementType"}},{title:"操作",width:"240px",align:"center",scopedSlots:{customRender:"action"}}],columnsLimit:[{title:"名称",align:"center",dataIndex:"authName",scopedSlots:{customRender:"authName",type:"input"},width:"240px"},{title:"标识",align:"center",dataIndex:"code",scopedSlots:{customRender:"code",type:"input"},width:"240px"},{title:"权限排序",align:"center",dataIndex:"orderNumber",scopedSlots:{customRender:"orderNumber",type:"inputNumber"},width:"240px"},{title:"操作",align:"center",scopedSlots:{customRender:"action"},width:"240px"}],rowSelection:$,selectedRowKeys:[],selectLimitKeys:[],expandedKeys:[],autoExpandParent:!0,checkedKeys:[],treeData:[],limitData:[],visible:!1,visibleLimit:!1,authType:"check",authList:[],rowData:{},RoleMenuData:{},roleName:"",dataUser:[],columnsUser:I,pagination:{current:1,pageSize:10},paginationSearch:{current:1,pageSize:10,total:10},keyword:"",record:{}}},methods:{classifyEdit:function(e){e.editable=!0,this.$forceUpdate()},classifyCancel:function(e){e.editable=!1,this.$forceUpdate()},classifyDelete:function(e,t){var a=this;this.$confirm({title:"警告",content:"是否删除这条的数据？",onOk:function(){var n=Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:Object(o["k"])({id:e.id}).then((function(e){e.success&&(a.limitData.splice(t,1),a.$forceUpdate())}));case 1:case"end":return n.stop()}}),n)})));function i(){return n.apply(this,arguments)}return i}()})},classifySave:function(e){var t=this,a=e.id?o["n"]:o["i"];a(Object(r["a"])({},e,{menuId:this.RoleMenuData.id})).then((function(a){a.success?(t.$message.success("添加成功"),e.editable=!1,t.$forceUpdate()):t.$message.info("添加失败")}))},limitSubmit:function(){var e=this,t=[];this.limitData.forEach((function(e){e.permitted&&t.push(e.id)}));var a=this.selectLimitKeys.filter((function(e){return!t.includes(e)})),n=t.filter((function(t){return!e.selectLimitKeys.includes(t)}));a.length&&Object(o["j"])({authId:a,roleId:this.rowData.id}).then((function(t){t.success?(e.$notification.success({message:"成功",description:t.msg}),e.visibleLimit=!1):e.$notification.error({message:"失败",description:t.msg})})),n.length&&Object(o["m"])({authId:n,roleId:this.rowData.id}).then((function(t){t.success?(e.$notification.success({message:"成功",description:t.msg}),e.visibleLimit=!1):e.$notification.error({message:"失败",description:t.msg})})),a.length||n.length||(this.visibleLimit=!1)},getMenu:function(){var e=this,t="",a=this.$ls.get("USER_INFO");1===a.superAdmin&&(t="1"),Object(o["M"])(t).then((function(t){if(t.success&&t.data.length>0){for(var a=0;a<t.data.length;a++){if(null==t.data[a].subMenus)delete t.data[a].subMenus;else if(t.data[a].subMenus.length>0){t.data[a].children=t.data[a].subMenus;for(var n=0;n<t.data[a].children.length;n++)t.data[a].children[n].title=t.data[a].children[n].name,t.data[a].children[n].key=t.data[a].children[n].id;delete t.data[a].subMenus}t.data[a].title=t.data[a].name,t.data[a].key=t.data[a].id}e.treeData=t.data}else e.$notification.warning({message:"提示",description:"暂无访问权限"}),e.$router.push({path:"/403"})})).catch((function(t){e.data=[],e.$notification["error"]({message:"错误",description:((t.response||{}).data||{}).message||"渲染失败",duration:4})}))},checkAuth:function(e){var t=this;this.RoleMenuData=e,Object(o["l"])({menuId:e.id,roleId:this.rowData.id}).then((function(e){t.authList=e.data,t.authType="check",t.visibleLimit=!0}))},updateAuth:function(e){var t=this;this.RoleMenuData=e,this.authType="edit",Object(o["l"])({menuId:e.id,roleId:this.rowData.id}).then((function(e){t.limitData=e.data,t.selectLimitKeys=[],t.limitData.forEach((function(e){e.permitted&&t.selectLimitKeys.push(e.id)})),t.visibleLimit=!0}))},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onCheck:function(e){this.checkedKeys=e},parentFn:function(e){this.getRole()},getRole:function(){var e=this;Object(o["Q"])(this.roleName).then((function(t){e.data=t.data}))},edit:function(e){this.$refs.createRole.add(e,"edit")},handeAddaut:function(e){var t=this;this.rowData=e,this.visible=!0,Object(o["R"])(e.id).then((function(e){t.checkedKeys=e.data,t.selectedRowKeys=e.data})).catch((function(){t.$notification["error"]({message:"查询失败",duration:4})}))},handleDelete:function(e){var t=this;this.$confirm({title:"警告?",content:"是否删除该角色",onOk:function(){Object(o["v"])(e.id).then((function(e){e.success?(t.getRole(),t.$notification["warning"]({message:"删除成功",duration:4})):t.$notification["warning"]({message:e.msg||"删除失败",duration:4})})).catch((function(e){t.$notification["error"]({message:e.message||"删除失败",duration:4})}))},onCancel:function(){}})},menAction:function(){var e=this,t={roleId:this.rowData.id,menuId:this.selectedRowKeys};Object(o["vb"])(t).then((function(t){t.success?(e.visible=!1,e.$notification["success"]({message:"成功",description:t.msg})):e.$notification["error"]({message:"失败",description:t.msg})})).catch((function(){e.$notification["error"]({message:"授权失败",duration:4})}))},searchUser:function(e){var t=this;this.record=e,this.visible1=!0;var a={roleId:e.id,keyword:this.keyword,pageNum:this.paginationSearch.current,pageSize:this.paginationSearch.pageSize};Object(o["nb"])(a).then((function(e){t.paginationSearch.total=e.data.total,t.dataUser=e.data.records?e.data.records:[]}))},handleStepOk:function(){this.visible1=!1},pageChange:function(e){this.pagination=e},pageChangeSearch:function(e){this.paginationSearch=e,this.searchUser(this.record)},handleSearch:function(){this.paginationSearch.current=1,this.searchUser(this.record)},onSelectChange:function(e){this.selectedRowKeys=e},onSelectLimitChange:function(e){this.selectLimitKeys=e},getTitle:function(){var e="添加权限";return"check"==this.authType?e="查看权限":"edit"==this.authType&&(e="编辑权限"),e}},mounted:function(){this.getRole(),this.getMenu()}},C=N,j=(a("2abb"),Object(w["a"])(C,n,i,!1,null,"a93937b8",null));t["default"]=j.exports},"2abb":function(e,t,a){"use strict";var n=a("0e14"),i=a.n(n);i.a}}]);